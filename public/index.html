<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="keywords" content="todo pwa" />
    <meta name="description" content="todo pwa" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="/favicon.ico" />
    <link rel="manifest" href="/manifest.json" />
    <title>Todo PWA</title>
  </head>
  <body>
    <main>
      <h1>Todo PWA</h1>
      <p>Network Status: <span id="network-status"></span></p>
      <form id="form">
        <div>
          <input name="text" type="text" />
          <button>Create</button>
        </div>
      </form>
      <div id="list"></div>
    </main>
    <script src="/IndexedDb.js"></script>
    <script src="/Stats.js"></script>
    <script src="/utils.js"></script>
    <script src="/main.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          const dataList = document.getElementById('list');

          navigator.serviceWorker.ready
            .then(() => navigator.serviceWorker.getRegistration())
            .then((serviceWorkerRegistration) => serviceWorkerRegistration.sync.register('sync'))
            .then(() => {
              console.log('%c request synchronization', 'color: #5C3B02');
            });

          navigator.serviceWorker.addEventListener('message', (event) => {
            console.log('%c synchronization complete', 'color: #00C9A7');
          });

          function renderList(data) {
            if (data.length <= 0) {
              return createElement('div', null, 'No Data');
            }
            const children = data.map((item) => createElement('li', null, item.text));
            return createElement('ul', null, ...children);
          }

          const stats = new Stats();
          document.getElementById('network-status').appendChild(stats.domElement);
          window.addEventListener('offline', () => stats.update());
          window.addEventListener('online', () => stats.update());
        });
      }
    </script>
  </body>
</html>
